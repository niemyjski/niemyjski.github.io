<!doctype html><html lang=en><head><link rel=dns-prefetch href=https://fonts.googleapis.com><link rel=dns-prefetch href=https://use.fontawesome.com><link rel=dns-prefetch href=https://fonts.gstatic.com><link rel=dns-prefetch href=https://cdnjs.cloudflare.com><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blakeniemyjski.com\/"},"articleSection":"blog","name":"Implementing GoTo Line functionality in a Visual Studio Custom Editor","headline":"Implementing GoTo Line functionality in a Visual Studio Custom Editor","description":"While implementing a custom CodeSmith Generator Template Editor into Visual Studio 2010. I ran into an issue with getting the GoTo Line functionality to work properly. According to Microsoft this functionality needs to be provided by the custom editor as well as the GoTo Line dialog will need to be implemented as there is no \x26ldquo;official public extension point\x26rdquo;. This makes sense if you are taking over control of the editor but I feel that Microsoft should expose this dialog.","inLanguage":"en","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2020","datePublished":"2011-06-02 19:15:09 \x2b0000 UTC","dateModified":"2011-06-02 19:15:09 \x2b0000 UTC","url":"https:\/\/blakeniemyjski.com\/blog\/implementing-goto-line-functionality-in-a-visual-studio-custom-editor\/","wordCount":"297","keywords":["Visual Studio Extensibility","Blog"]}</script><title>Implementing GoTo Line functionality in a Visual Studio Custom Editor</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.65.0"><meta name=description content="Blake Niemyjski"><meta name=twitter:card content="summary"><meta name=twitter:title content="Implementing GoTo Line functionality in a Visual Studio Custom Editor"><meta name=twitter:description content="While implementing a custom CodeSmith Generator Template Editor into Visual Studio 2010. I ran into an issue with getting the GoTo Line functionality to work properly. According to Microsoft this functionality needs to be provided by the custom editor as well as the GoTo Line dialog will need to be implemented as there is no &ldquo;official public extension point&rdquo;. This makes sense if you are taking over control of the editor but I feel that Microsoft should expose this dialog."><meta name=twitter:site content="@blaken"><meta property="og:title" content="Implementing GoTo Line functionality in a Visual Studio Custom Editor"><meta property="og:description" content="While implementing a custom CodeSmith Generator Template Editor into Visual Studio 2010. I ran into an issue with getting the GoTo Line functionality to work properly. According to Microsoft this functionality needs to be provided by the custom editor as well as the GoTo Line dialog will need to be implemented as there is no &ldquo;official public extension point&rdquo;. This makes sense if you are taking over control of the editor but I feel that Microsoft should expose this dialog."><meta property="og:type" content="article"><meta property="og:url" content="https://blakeniemyjski.com/blog/implementing-goto-line-functionality-in-a-visual-studio-custom-editor/"><meta property="article:published_time" content="2011-06-02T19:15:09+00:00"><meta property="article:modified_time" content="2011-06-02T19:15:09+00:00"><meta property="og:image" content="https://blakeniemyjski.com//images/logo.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="512"><meta property="og:image:height" content="512"><meta itemprop=name content="Implementing GoTo Line functionality in a Visual Studio Custom Editor"><meta itemprop=description content="While implementing a custom CodeSmith Generator Template Editor into Visual Studio 2010. I ran into an issue with getting the GoTo Line functionality to work properly. According to Microsoft this functionality needs to be provided by the custom editor as well as the GoTo Line dialog will need to be implemented as there is no &ldquo;official public extension point&rdquo;. This makes sense if you are taking over control of the editor but I feel that Microsoft should expose this dialog."><meta itemprop=datePublished content="2011-06-02T19:15:09+00:00"><meta itemprop=dateModified content="2011-06-02T19:15:09+00:00"><meta itemprop=wordCount content="297"><meta itemprop=keywords content="Visual Studio Extensibility,"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700&display=swap"><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.12.0/css/all.css><link rel=stylesheet href=https://blakeniemyjski.com/css/main.css><link href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/vs.min.css rel=stylesheet type=text/css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-3422587-1','auto');ga('send','pageview');}</script></head><body><div id=wrapper><header id=header><h1><a href=https://blakeniemyjski.com/>blog</a></h1><nav class=links><ul><li><a href=https://blakeniemyjski.com/><i class="fas fa-home"></i>&nbsp;Home</a></li><li><a href=https://blakeniemyjski.com/categories/home-automation/><i class="fas fa-magic"></i>&nbsp;Home Automation</a></li><li><a href=https://blakeniemyjski.com/categories/programming/><i class="fas fa-code"></i>&nbsp;Programming</a></li><li><a href=https://blakeniemyjski.com/categories/review/><i class="fas fa-book"></i>&nbsp;Reviews</a></li><li><a href=https://blakeniemyjski.com/categories/public-speaking/><i class="fas fa-comments"></i>&nbsp;Public Speaking</a></li><li><a href=https://blakeniemyjski.com/about/><i class="fas fa-id-card"></i>&nbsp;About</a></li></ul></nav><nav class=main><ul><li id=share-nav class=share-menu style=display:none><a class=fa-share-alt href=#share-menu>Share</a></li><li class=search><a class=fa-search href=#search>Search</a><form id=search method=get action=//google.com/search><input type=text name=q placeholder=Search>
<input type=hidden name=as_sitesearch value=https://blakeniemyjski.com/></form></li><li class=menu><a class=fa-bars href=#menu>Menu</a></li></ul></nav></header><section id=menu><section><form class=search method=get action=//google.com/search><input type=text name=q placeholder=Search>
<input type=hidden name=as_sitesearch value=https://blakeniemyjski.com/></form></section><section><ul class=links><li><a href=https://blakeniemyjski.com/><h3><i class="fas fa-home"></i>&nbsp;Home</h3></a></li><li><a href=https://blakeniemyjski.com/categories/home-automation/><h3><i class="fas fa-magic"></i>&nbsp;Home Automation</h3></a></li><li><a href=https://blakeniemyjski.com/categories/programming/><h3><i class="fas fa-code"></i>&nbsp;Programming</h3></a></li><li><a href=https://blakeniemyjski.com/categories/review/><h3><i class="fas fa-book"></i>&nbsp;Reviews</h3></a></li><li><a href=https://blakeniemyjski.com/categories/public-speaking/><h3><i class="fas fa-comments"></i>&nbsp;Public Speaking</h3></a></li><li><a href=https://blakeniemyjski.com/about/><h3><i class="fas fa-id-card"></i>&nbsp;About</h3></a></li></ul></section><section class=recent-posts><div class=mini-posts><header><h3>Recent Posts</h3></header><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/home-automation/thinking-about-smart-home-power-usage/>Thinking about smart home power usage</a></h3><time class=published datetime=2020-02-13>February 13, 2020</time></header></article><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/home-automation/hello-home-automation-how-to-detect-battery-levels-with-node-red/>Hello Home Automation, How to detect battery levels with Node-RED</a></h3><time class=published datetime=2020-02-03>February 3, 2020</time></header></article><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/blog/speaking-at-bam/>Speaking at BAM</a></h3><time class=published datetime=2019-02-19>February 19, 2019</time></header></article><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/blog/speaking-at-central-wisconsin-it-conference/>Speaking at Central Wisconsin It Conference</a></h3><time class=published datetime=2018-10-04>October 4, 2018</time></header></article><a href=/categories/ class=button>View more posts</a></div></section></section><section id=share-menu><section id=social-share-nav><ul class=links><header><h3>Share this post <i class="fas fa-smile"></i></h3></header><li><a href="//twitter.com/share?url=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f&text=Implementing%20GoTo%20Line%20functionality%20in%20a%20Visual%20Studio%20Custom%20Editor&via=blaken" target=_blank rel=noopener class="share-btn twitter"><i class="fab fa-twitter"></i><p>Twitter</p></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f" target=_blank rel=noopener class="share-btn facebook"><i class="fab fa-facebook"></i><p>Facebook</p></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f&title=Implementing%20GoTo%20Line%20functionality%20in%20a%20Visual%20Studio%20Custom%20Editor" target=_blank rel=noopener class="share-btn reddit"><i class="fab fa-reddit-alien"></i><p>Reddit</p></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f&title=Implementing%20GoTo%20Line%20functionality%20in%20a%20Visual%20Studio%20Custom%20Editor" target=_blank rel=noopener class="share-btn linkedin"><i class="fab fa-linkedin"></i><p>LinkedIn</p></a></li><li><a href="mailto:?subject=Check out this post by &body=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f" target=_blank rel=noopener class="share-btn email"><i class="fas fa-envelope"></i><p>Email</p></a></li></ul></section></section><div id=main><article class=post><header><div class=title><h1><a href=https://blakeniemyjski.com/blog/implementing-goto-line-functionality-in-a-visual-studio-custom-editor/>Implementing GoTo Line functionality in a Visual Studio Custom Editor</a></h1></div><div class=meta><time class=published datetime=2011-06-02>June 2, 2011</time>
<span class=author></span><p>2 minute read</p></div></header><section id=social-share><ul class=icons><li><a href="//twitter.com/share?url=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f&text=Implementing%20GoTo%20Line%20functionality%20in%20a%20Visual%20Studio%20Custom%20Editor&via=blaken" target=_blank rel=noopener class="share-btn twitter"><i class="fab fa-twitter"></i><p>Twitter</p></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f" target=_blank rel=noopener class="share-btn facebook"><i class="fab fa-facebook"></i><p>Facebook</p></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f&title=Implementing%20GoTo%20Line%20functionality%20in%20a%20Visual%20Studio%20Custom%20Editor" target=_blank rel=noopener class="share-btn reddit"><i class="fab fa-reddit-alien"></i><p>Reddit</p></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f&title=Implementing%20GoTo%20Line%20functionality%20in%20a%20Visual%20Studio%20Custom%20Editor" target=_blank rel=noopener class="share-btn linkedin"><i class="fab fa-linkedin"></i><p>LinkedIn</p></a></li><li><a href="mailto:?subject=Check out this post by &body=https%3a%2f%2fblakeniemyjski.com%2fblog%2fimplementing-goto-line-functionality-in-a-visual-studio-custom-editor%2f" target=_blank rel=noopener class="share-btn email"><i class="fas fa-envelope"></i><p>Email</p></a></li></ul></section><div id=content><p>While implementing a custom <a href=https://blakeniemyjski.com/programming/programming/announcing-the-codesmith-generator-6-0-visual-studio-template-editor/>CodeSmith Generator Template Editor into Visual Studio 2010</a>.
I ran into an issue with getting the GoTo Line functionality to work properly.
According to <a href=https://social.msdn.microsoft.com/Forums/en-US/vsx/thread/b8cbb1de-ab99-48af-ae5a-78808ef3208c>Microsoft</a>
this functionality needs to be provided by the custom editor as well as the
GoTo Line dialog will need to be implemented as there is no &ldquo;official public
extension point&rdquo;. This makes sense if you are taking over control of the editor
but I feel that Microsoft should expose this dialog. I was able to implement
this functionality by adding a command to the <code>IMenuCommandService</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>var</span> mcs = GetService(<span style=color:#66d9ef>typeof</span> (IMenuCommandService)) <span style=color:#66d9ef>as</span> IMenuCommandService;
<span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>null</span> != mcs)
    addCommand(mcs, VSConstants.GUID_VSStandardCommandSet97, (<span style=color:#66d9ef>int</span>) VSConstants.VSStd97CmdID.Goto, OnGoTo, OnQueryGoTo);
....
<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>void</span> addCommand(
    IMenuCommandService mcs, Guid menuGroup, <span style=color:#66d9ef>int</span> cmdID, EventHandler commandEvent, EventHandler queryEvent
) {}
</code></pre></div><p>Next, I see if the command should be enabled by seeing if the current document
has any lines of text. Then I make a call to the &ldquo;internal&rdquo; Microsoft Dialog
GoTo dialog that provides validation and help text. Please note that this code
requires the following import block and is subject to change in future versions
of Visual Studio.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=color:#66d9ef>using</span> Microsoft.Internal.VisualStudio.PlatformUI;
<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> OnQueryGoTo(<span style=color:#66d9ef>object</span> sender, EventArgs e)
{
    <span style=color:#66d9ef>var</span> command = (OleMenuCommand)sender;
    command.Enabled = EditorControl.LineCount &gt; <span style=color:#ae81ff>0</span>;
}

<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>void</span> OnGoTo(<span style=color:#66d9ef>object</span> sender, EventArgs e)
{
    <span style=color:#66d9ef>var</span> lineNumber = GetGoToLineNumberFromDialog();
    <span style=color:#66d9ef>if</span> (lineNumber &lt; <span style=color:#ae81ff>0</span>)
        <span style=color:#66d9ef>return</span>;

    ((IVsFindTarget) <span style=color:#66d9ef>this</span>).NavigateTo(
        <span style=color:#66d9ef>new</span> TextSpan[] { <span style=color:#66d9ef>new</span> TextSpan { iStartLine = lineNumber, iStartIndex = <span style=color:#ae81ff>0</span>,
                                        iEndLine = lineNumber, iEndIndex = <span style=color:#ae81ff>0</span> }});
}

<span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> GetGoToLineNumberFromDialog()
{
    <span style=color:#66d9ef>var</span> dataSource = <span style=color:#66d9ef>new</span> UIDataSource();
    dataSource.AddBuiltInProperty(<span style=color:#e6db74>&#34;MinimumLine&#34;</span>, <span style=color:#ae81ff>1</span>);
    dataSource.AddBuiltInProperty(<span style=color:#e6db74>&#34;MaximumLine&#34;</span>, EditorControl.LineCount);
    dataSource.AddBuiltInProperty(<span style=color:#e6db74>&#34;CurrentLine&#34;</span>, EditorControl.CurrentLine);
    WindowHelper.AddHelpTopic(dataSource, <span style=color:#e6db74>&#34;vs.gotoline&#34;</span>);
    <span style=color:#66d9ef>if</span> (WindowHelper.ShowModalElement(VSConstants.GUID_VSStandardCommandSet97, <span style=color:#ae81ff>231</span>, dataSource) == <span style=color:#ae81ff>1</span>)
    {
        <span style=color:#66d9ef>var</span> result = <span style=color:#66d9ef>new</span> UIObject(dataSource[<span style=color:#e6db74>&#34;CurrentLine&#34;</span>]);
        <span style=color:#66d9ef>return</span> (((<span style=color:#66d9ef>int</span>)result.Data) - <span style=color:#ae81ff>1</span>);
    }

    <span style=color:#66d9ef>return</span> -<span style=color:#ae81ff>1</span>;
}
</code></pre></div><p>If anyone comes across a better way to accomplish this, by all means let me know!</p></div><footer><ul class=stats><li class=categories><ul><i class="fas fa-folder"></i><li><a class=article-category-link href=https://blakeniemyjski.com/categories/programming>Programming</a></li></ul></li><li class=tags><ul><i class="fas fa-tags"></i><li><a class=article-category-link href=https://blakeniemyjski.com/tags/visual-studio-extensibility>Visual Studio Extensibility</a></li></ul></li></ul></footer></article><article class=post><div class=disqus></div><script>(function(){var disqus_shortname='niemyjski';window.disqusLoaderSettings={element:'.disqus',options:{scriptUrl:'//'+disqus_shortname+'.disqus.com/embed.js',disqusConfig:function(){this.page.url="https:\/\/blakeniemyjski.com\/blog\/implementing-goto-line-functionality-in-a-visual-studio-custom-editor\/";this.page.identifier="https:\/\/blakeniemyjski.com\/blog\/implementing-goto-line-functionality-in-a-visual-studio-custom-editor\/";}}};})();</script></article><ul class="actions pagination"><li><a href=https://blakeniemyjski.com/blog/announcing-the-codesmith-generator-6.0-visual-studio-template-editor/ class="button big previous">Announcing The CodeSmith Generator 6.0 Visual Studio Template Editor</a></li><li><a href=https://blakeniemyjski.com/blog/how-to-open-a-visual-studio-document-window-using-the-visual-studio-api/ class="button big next">How-to open a Visual Studio Document Window using the Visual Studio API</a></li></ul></div><section id=sidebar><section id=intro><a href=https://blakeniemyjski.com/><img src=https://blakeniemyjski.com/img/logo.jpeg class=intro-circle width=250 alt="Blake Niemyjski"></a><header><h2>Blake Niemyjski</h2><p>Passionate about building software</p></header><ul class=icons><li><a href=https://blakeniemyjski.com/index.xml type=application/rss+xml target=_blank title=RSS><i class="fas fa-rss"></i></a></li><li><a href=//github.com/niemyjski target=_blank title=GitHub><i class="fab fa-github"></i></a></li><li><a href=//stackoverflow.com/users/199701 target=_blank title="Stack Overflow"><i class="fab fa-stack-overflow"></i></a></li><li><a href=//linkedin.com/in/niemyjski target=_blank title=LinkedIn><i class="fab fa-linkedin"></i></a></li><li><a href=//reddit.com/user/bniemyjski target=_blank title=Reddit><i class="fab fa-reddit"></i></a></li><li><a href=//youtube.com/bniemyjski target=_blank title=YouTube><i class="fab fa-youtube"></i></a></li><li><a href=//twitter.com/blaken target=_blank title=Twitter><i class="fab fa-twitter"></i></a></li><li><a href=mailto:bniemyjski@gmail.com title=Email><i class="fas fa-envelope"></i></a></li></ul></section><section class=recent-posts><div class=mini-posts><header><h3>Recent Posts</h3></header><div class=posts-container><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/home-automation/thinking-about-smart-home-power-usage/>Thinking about smart home power usage</a></h3><time class=published datetime=2020-02-13>February 13, 2020</time></header></article><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/home-automation/hello-home-automation-how-to-detect-battery-levels-with-node-red/>Hello Home Automation, How to detect battery levels with Node-RED</a></h3><time class=published datetime=2020-02-03>February 3, 2020</time></header></article><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/blog/speaking-at-bam/>Speaking at BAM</a></h3><time class=published datetime=2019-02-19>February 19, 2019</time></header></article><article class=mini-post><header><h3><a href=https://blakeniemyjski.com/blog/speaking-at-central-wisconsin-it-conference/>Speaking at Central Wisconsin It Conference</a></h3><time class=published datetime=2018-10-04>October 4, 2018</time></header></article></div><a href=/categories/ class=button>View more posts</a></div></section><section id=mini-bio><h3>About</h3><p>Blake Niemyjski is a full time open source software architect and private pilot. Since the late 90's, Blake's curiosity has been focused around developing software that helps the masses. As a hobbyist developer turned student and professional, Blake's passion is to further his knowledge and create technologies for the future.</p><a href=https://blakeniemyjski.com/about/ class=button>Learn More About Me</a></section><section id=footer><p class=copyright>&copy; 2020
Blake Niemyjski
.
Powered by <a href=//gohugo.io target=_blank rel=noreferrer>Hugo</a></p></section></section></div><a id=back-to-top href=# class="fas fa-arrow-up fa-border fa-2x"></a><script defer src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js></script><script defer src=https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js></script><script defer src=https://use.fontawesome.com/releases/v5.12.0/js/all.js></script><script defer src=https://blakeniemyjski.com/js/util.js></script><script defer src=https://blakeniemyjski.com/js/main.js></script><script defer src=https://blakeniemyjski.com/js/backToTop.js></script><script defer src=https://blakeniemyjski.com/js/disqusLoader.js></script><script defer src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script defer src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/vbnet.min.js></script><script defer src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/dockerfile.min.js></script><script defer src=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/dos.min.js></script><script defer src=https://blakeniemyjski.com/js/init-highlight.js></script></body></html>